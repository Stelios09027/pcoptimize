@echo off
title Microsoft Bloatware Annihilator - English Comments
color 0c

:: Check for Administrator Privileges
NET SESSION >nul 2>&1
if %errorLevel% neq 0 (
    echo [ERROR] Run as Administrator or it won't work!
    pause
    exit
)

echo ======================================================
echo    KILLING 70+ USELESS MICROSOFT BACKGROUND TASKS
echo ======================================================

:: 1. UNLOCK ULTIMATE PERFORMANCE POWER PLAN
echo [1/4] Enabling Ultimate Performance Plan...
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >nul 2>&1
for /f "tokens=4" %%a in ('powercfg -list ^| findstr "Ultimate"') do powercfg -setactive %%a

:: 2. DISABLE DEEP MICROSOFT SERVICES (The "Invisible" RAM Eaters)
echo [2/4] Disabling aggressive background services...

:: Windows Search & Indexing (Stops constant disk usage)
sc config WSearch start= disabled >nul 2>&1
sc stop WSearch >nul 2>&1

:: Windows Maps & Location
sc config MapsBroker start= disabled >nul 2>&1
sc config lfsvc start= disabled >nul 2>&1

:: Telemetry, Tracking & Error Reporting (Privacy & CPU boost)
sc config DiagTrack start= disabled >nul 2>&1
sc config dmwappushservice start= disabled >nul 2>&1
sc config WerSvc start= disabled >nul 2>&1
sc config PcaSvc start= disabled >nul 2>&1

:: Print Spooler (Useless if you don't have a printer)
sc config Spooler start= disabled >nul 2>&1
sc stop Spooler >nul 2>&1

:: Remote Registry & Distributed Link Tracking
sc config RemoteRegistry start= disabled >nul 2>&1
sc config TrkWks start= disabled >nul 2>&1

:: Xbox & Game Bar (Keeps your games clean)
sc config XblAuthManager start= disabled >nul 2>&1
sc config XblGameSave start= disabled >nul 2>&1
sc config XboxNetApiSvc start= disabled >nul 2>&1

:: 3. STOP HIDDEN MICROSOFT APPS (Bloatware)
echo [3/4] Terminating hidden Microsoft background apps...
taskkill /f /im OneDrive.exe /t >nul 2>&1
taskkill /f /im PhoneExperienceHost.exe /t >nul 2>&1
taskkill /f /im Cortana.exe /t >nul 2>&1
taskkill /f /im mscorsvw.exe /t >nul 2>&1
taskkill /f /im OfficeClickToRun.exe /t >nul 2>&1
taskkill /f /im SearchHost.exe /t >nul 2>&1

:: 4. ADVANCED REGISTRY TWEAKS (Speed Boost)
echo [4/4] Optimizing Kernel and System Response...
:: Disable Hibernate to save disk space and stop hiberfil.sys process
powercfg -h off >nul 2>&1
:: Force Windows to prioritize Games/Apps over background tasks
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v "SystemResponsiveness" /t REG_DWORD /d 0 /f >nul 2>&1
:: Disable Windows Tips & Soft Landing (Stops MS from "teaching" you)
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableSoftLanding" /t REG_DWORD /d 1 /f >nul 2>&1

echo.
echo ======================================================
echo   DONE! Discord, Steam, and Chrome are safe.
echo   Check your Task Manager after a REBOOT.
echo ======================================================
pause
exit
